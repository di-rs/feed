# Deployment Guide

## Cloudflare Pages Deployment

### Initial Setup

1. **Push to GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit: Feed reader site"
   git remote add origin YOUR_REPO_URL
   git push -u origin main
   ```

2. **Create Cloudflare Pages Project**
   - Go to [Cloudflare Dashboard](https://dash.cloudflare.com/) → Pages
   - Click "Create a project"
   - Select "Connect to Git"
   - Choose your GitHub repository
   - Configure build settings:
     - **Framework preset:** Astro
     - **Build command:** `npm run build`
     - **Build output directory:** `dist`
     - **Root directory:** `/` (leave blank)
     - **Node version:** 18 or later
   - Click "Save and Deploy"

3. **Configure Custom Domain**
   - After deployment, go to your Pages project
   - Click "Custom domains" tab
   - Add `feed.dimaportish.com`
   - Follow DNS configuration instructions
   - Wait for SSL certificate provisioning (~15 minutes)

### Continuous Deployment

Once connected, Cloudflare Pages will automatically:
- Build on every push to `main`
- Create preview deployments for pull requests
- Deploy to production when builds succeed

### Manual Deployment (Alternative)

Using Wrangler CLI:

```bash
# Install Wrangler
npm install -g wrangler

# Login to Cloudflare
wrangler login

# Build the site
npm run build

# Deploy to Pages
wrangler pages deploy dist --project-name=feed
```

### Environment Variables

None required! This is a static site that reads from the filesystem at build time.

### Build Time

Expected build time: 30-60 seconds

### Content Updates

Posts are generated by a cron job. After new posts are added:
1. Commit the new markdown files to git
2. Push to GitHub
3. Cloudflare automatically rebuilds and deploys

Or trigger a manual rebuild from the Cloudflare dashboard.

### Troubleshooting

**Build fails with "content collection not found"**
- Ensure `src/content/posts/` directory exists
- Check that at least one post file is present

**Fonts not loading**
- Verify fonts are in `public/fonts/` directory
- Check browser console for 404 errors
- Ensure font paths in CSS match actual filenames

**Dark mode not working**
- Check browser localStorage for `theme` key
- Clear cache and reload
- Verify JavaScript is enabled

**Posts not appearing**
- Check frontmatter format matches schema in `src/content/config.ts`
- Validate date/time formats (YYYY-MM-DD, HH:MM)
- Run `npm run build` locally to test

### Performance Optimization

Already optimized:
- ✅ Static site generation (SSG)
- ✅ Minimal JavaScript
- ✅ Optimized fonts (woff2, font-display: swap)
- ✅ Image lazy loading
- ✅ Responsive images

Further optimizations if needed:
- Enable Cloudflare's Auto Minify (HTML, CSS, JS)
- Use Cloudflare's Polish for image optimization
- Enable Brotli compression
- Configure Cache Rules for fonts/images

### Monitoring

Monitor your site with:
- Cloudflare Pages Analytics (built-in)
- Cloudflare Web Analytics (add script to Layout.astro)
- Lighthouse CI for performance tracking
